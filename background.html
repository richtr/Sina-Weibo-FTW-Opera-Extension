<!DOCTYPE html>
<script>

var transactionSources = {};

opera.extension.addEventListener('message', function(msg) {
  
  if(!msg.data || !msg.data.action) return;
  
  if(msg.data.action == "registerTransaction") {
    
    transactionSources[msg.data.id] = msg.source;
    
  } else if(msg.data.action == "deliverTransaction") {
    
    if(transactionSources[msg.data.id]) {
      
      transactionSources[msg.data.id].postMessage( msg.data );
      
      delete transactionSources[msg.data.id];
      
    }
    
  }
  
}, true);

</script>